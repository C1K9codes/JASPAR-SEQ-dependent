# load the required libraries/packages
library(TFBSTools)
library(Biostrings)
library(JASPAR2022)
library(dplyr)
library(writexl)
library(knitr)
library(kableExtra)

# Using biostrings package store DNA sequence to be scanned across for TFs
ABCB1_distal <- DNAString("AAATTAGCTTTATGGAAATTCATTTGTTTACTTTGCAATTATATCAGTATTTAATTTATAATGAAAAAGTTGTGTT
CCAAAGAAATGTTAATTTTCACAATGTTTTAGCACAAATTGAAGGAAGGAGTAAAGTATAAAATAAAACTTTGTAAATGACTGAGCTGTCACAGAGAGAAAAAA
TGAGTTGACAAATACTTTTCTCAATTACAGAAAAGTAGACAGAATAGTGATAAGTAACCAAAATCTTTTAAGAGTTAAGAATGCATTTTGGAATCTGTGTATGT
ATTGTGGGATCTGGCCAGCAGCCTGCAATGCAACGGGGCTCTCTCTTTGTTCTTAGGCGGATCGGCAGGTTGAGAAATAATAGACACACACAAGATAGTGAAAG
CTGGGTCCAGGGGGGTCACTACCTTCTGGTCCCACGGTGCCAACAATGCACTGGATATACCAGCATTTATTATTAAGTTTAGTGAGGGCAGGGGTAGGTTAGTG
AGGGATTTAGGGTCATTTGATTATGAGGTGAGATGGTCACATGGGGATGAAGTAATTCTTTAACATAACATTTGTATATAGAAGTACAGTACATTTGTATGGAG
AAGTACAGTATACAGAGATAAGAATTTACAATATAGTGTGTGTGTTAGTAATTTCTAACAGAGCCTTAAAACAGAAACACAATCTTTCCATAACCTATGATTAG
CAAGATATTAATCAGCAGTAACAGTTGCAACAAAAGCTGGTTACAAACAATCCATGGAAATAGGACGTGAAGATAGACAACTGGTTAGACGAGAAATTCTCAGA
AAGGAGTATGCCTTAACCCTAAAGAGGTGTAGAAGAGCCATGGCAAGATGAGGACGTTTATAGCCCTATCTTATCCATATGGACAGGCACCCCCCCGCCCCATG
CATCCGTTTATAGGCTCTCCACAAGGGTCGCATTCCATTCCTAGAGCTATGAACATCTGCTTTTCTGGGATAGGAATCTTGGTGATGTGAAACCTCCCTGACCG
CACGTCCATTCATAGGCTCTCTGCAGGGGGAAGCACGTCACGCGCTGTTGGCTCATTCTGGCAGTCCAACCTGCATTGTCTTTACACAATACTGCATGCAATTT
TGTATTTACAATAATTAGGAGCATTTCATCTTTTATTCTGTAGCAATAGTTTCAGGGGGTCTCCCTACATCTTTCTCTATTCCTTTCACTGTGAGCAAAAAGTT
TGACTTAAGTAAAAGGCAGCAAATTCAATGCAATAACTCCAGTGAAGCCACAGGTAGTGTGAAATGCTATAAAGGATGAGGGAAATATAAATATTATATATATA
ATATTATAAATATATAATATTTAATATATAAGGACTTTATATATATAATTATATTATATATAATTAATTTATAATAATTATATATAATTAATTTATAATAATTA
TATATAATTAATTTATAATAATTATATATAATTAATTTATAATAATTATATATAATTAATTTATAATAATTA")

# Get human motifs
opts <- list(species = 9606) 
motifs <- getMatrixSet(JASPAR2022, opts)
 
# Convert motifs to PWM using log2 probability ratios
pwm <- toPWM(motifs, type = "log2probratio")

# Applying searchseq command from TFBSTools to scan stored DNA sequence
hitsdist <- searchSeq(pwm, ABCB1_distal, seqname = "ABCB1_distal", min.score = "95%", strand = "*")
hits_filtered_distal <- hitsdist[sapply(hitsdist, length) > 0]
hits_df_distal <- do.call(rbind, lapply(hits_filtered_distal, 
                                        as.data.frame))
hits_df_distal$TF <- rep(names(hits_filtered_distal), 
                         sapply(hits_filtered_distal, length))
# View result in table format using kableExtra
kable(head(hits_df_distal, 42), booktabs = TRUE, longtable = TRUE) %>%
kable_styling(latex_options = c("striped", "scale_down"))

View(hits_filtered_distal)
